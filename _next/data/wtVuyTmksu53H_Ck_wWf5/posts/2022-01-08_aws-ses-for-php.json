{"pageProps":{"blog":{"id":"2022-01-08_aws-ses-for-php","title":"AWS SDK for PHP を使ってメール送信","publishedAt":"2022-01-08","body":"<p>Amazon SES を初めて使ったのでメモ。<br>\nregionが<code>Asia Pacific (Tokyo)</code>の場合は制限があるみたいなので注意。</p>\n<table>\n<thead>\n<tr>\n<th>最大送信量</th>\n<th>1日あたりの送信割り当て</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>1秒あたり1通</td>\n<td>24時間あたり200通</td>\n</tr>\n</tbody>\n</table>\n<h3>前提</h3>\n<ul>\n<li><a href=\"https://aws.amazon.com/jp/sdk-for-php/\">AWS SDK for PHP</a>がインストール済みであること\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/sdk-for-php/v3/developer-guide/getting-started_installation.html\">インストール方法</a></li>\n</ul>\n</li>\n<li>Amazon SES でVerified済みのメールアドレスがあること</li>\n</ul>\n<h3>コード</h3>\n<pre><code>&#x3C;?php\nrequire 'vendor/autoload.php';\n\n$client = new \\Aws\\Ses\\SesClient([\n    'version' => 'latest',\n    'region' => 'ap-northeast-1',\n    'credentials' => [\n        'key'    => 'hogehoge',\n        'secret' => 'fugafuga',\n    ],\n]);\n\n$from = 'from@example.com'; // Amazon SESでVerifiedしたメールアドレス\n$to = 'to@example.com';\n$charset = 'UTF-8';\n$subject = '件名';\n$body = '本文';\n\n$result = $client->sendEmail([\n    'Destination' => [\n        'ToAddresses' => [$to],\n    ],\n    'ReplyToAddresses' => [$from],\n    'Source' => $from,\n    'Message' => [\n        'Body' => [\n            'Text' => [\n                'Charset' => $charset,\n                'Data' => $body,\n            ],\n        ],\n        'Subject' => [\n            'Charset' => $charset,\n            'Data' => $subject,\n        ],\n    ],\n]);\n\n// 送信ID\n$messageId = $result['MessageId'];\necho \"Email send. Message ID: {$messageId}\\n\" ;\n</code></pre>\n<p>HTML形式で送信したい場合は、<code>Text</code>を<code>Html</code>にすればOK。</p>\n<h3>参考</h3>\n<ul>\n<li><a href=\"https://docs.aws.amazon.com/aws-sdk-php/v3/api/class-Aws.Ses.SesClient.html\">Class Aws\\Ses\\SesClient | AWS SDK for PHP v3</a></li>\n<li><a href=\"https://officekaizen.tech/doku.php/aws/ses/aws-sdk%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%A6%E3%83%A1%E3%83%BC%E3%83%AB%E9%80%81%E4%BF%A1%E3%83%86%E3%82%B9%E3%83%88?s%5B%5D=ses\">aws:ses:aws-sdkを使ってメール送信テスト</a></li>\n</ul>\n"}},"__N_SSG":true}